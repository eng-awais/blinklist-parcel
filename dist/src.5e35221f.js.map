{"version":3,"sources":["src/analytics-api.js","src/data.json","node_modules/nanoid/url-alphabet/index.js","node_modules/nanoid/index.browser.js","src/index.js"],"names":["trackPageview","params","console","log","concat","exports","trackEvent","module","article1","content","control","description","image","test","ctr","article2","article3","urlAlphabet","_index","require","random","bytes","crypto","getRandomValues","Uint8Array","customRandom","alphabet","defaultSize","getRandom","mask","Math","length","LN2","step","size","arguments","undefined","id","j","customAlphabet","nanoid","reduce","byte","toString","toUpperCase","_analyticsApi","_data","_interopRequireDefault","_nanoid","obj","__esModule","default","assignVariation","articleId","variations","uniqueId","assignedVariation","JSON","parse","localStorage","getItem","randomVariation","floor","setItem","stringify","variation","trackSignUpClick","event","determineWinningVariation","article","ctrData","data","winningVariation","maxCTR","renderArticle","articleContainer","document","querySelector","articleContent","innerHTML","getCurrentArticleId","visitor","Object","keys","signUpButton","getElementById","addEventListener"],"mappings":"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","file":"src.5e35221f.js","sourceRoot":"..","sourcesContent":["/**\n * Tracks a pageview to our \"imaginary api\" - in this demo just the browser console. ;)\n * Send as params whatever you might seem valuable to send.\n * The URL is probably a good start though.\n */\nexport const trackPageview = (params) => {\n  console.log(`--> Tracking Pageview: ${params}`);\n};\n\n/**\n * Tracks an event to our \"imaginary api\" - in this demo just the browser console. ;)\n * Send as params whatever you might seem valuable to send.\n * The URL and an event name are probably a good start though.\n */\nexport const trackEvent = (params) => {\n  console.log(`--> Tracking Event: ${params}`);\n};\n","module.exports={article1:{content:{control:{description:\"Meet the app that revolutionized reading.\",image:\"https://wallpapers.com/images/featured/a5u9zq0a0ymy2dug.jpg\"},test:{description:\"Meet the app that has 18 million users.\",image:\"https://www.shutterstock.com/image-photo/micro-peacock-feather-hd-imagebest-260nw-1127238584.jpg\"}},ctr:{control:.25,test:.35}},article2:{content:{control:{description:\"Discover the best books of all time.\",image:\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSDAvwWXpNfmwHL1kyqdGsdvcJ0s123id-j6EGc4d50Jg&s\"},test:{description:\"Unlock the wisdom of the greatest books.\",image:\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRl43s4Lohzfsmmeeb3n7koFtc91VWO2Q9Ii67Z377A-MQ1UMiHxBnSWDmg8SrZB4n-r_k&usqp=CAU\"}},ctr:{control:.18,test:.22}},article3:{content:{control:{description:\"Learn new skills in just 15 minutes a day.\",image:\"https://w0.peakpx.com/wallpaper/525/221/HD-wallpaper-biology-3-d-science.jpg\"},test:{description:\"Acquire knowledge with bite-sized learning.\",image:\"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQQgEzF-fQzf6j2kyoEO1PGrPQ7K6suAF5WoQ&usqp=CAU\"}},ctr:{control:.12,test:.14}}};","export const urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\n","export { urlAlphabet } from './url-alphabet/index.js'\nexport let random = bytes => crypto.getRandomValues(new Uint8Array(bytes))\nexport let customRandom = (alphabet, defaultSize, getRandom) => {\n  let mask = (2 << (Math.log(alphabet.length - 1) / Math.LN2)) - 1\n  let step = -~((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let j = step\n      while (j--) {\n        id += alphabet[bytes[j] & mask] || ''\n        if (id.length === size) return id\n      }\n    }\n  }\n}\nexport let customAlphabet = (alphabet, size = 21) =>\n  customRandom(alphabet, size, random)\nexport let nanoid = (size = 21) =>\n  crypto.getRandomValues(new Uint8Array(size)).reduce((id, byte) => {\n    byte &= 63\n    if (byte < 36) {\n      id += byte.toString(36)\n    } else if (byte < 62) {\n      id += (byte - 26).toString(36).toUpperCase()\n    } else if (byte > 62) {\n      id += '-'\n    } else {\n      id += '_'\n    }\n    return id\n  }, '')\n","import { trackPageview, trackEvent } from './analytics-api.js';\nimport data from './data.json';\nimport { nanoid } from 'nanoid';\n\n// Function to assign a random variation to a visitor for an article.\nconst assignVariation = (articleId, variations) => {\n  // generate unique ID for visitor\n  const uniqueId = nanoid();\n  const assignedVariation = JSON.parse(localStorage.getItem('visitor'));\n\n  if (!assignedVariation) {\n    const randomIndex = Math.floor(Math.random() * (variations.length - 0)) + 0;\n    const randomVariation = variations[randomIndex];\n    localStorage.setItem(\n      'visitor',\n      JSON.stringify({\n        id: uniqueId,\n        variation: randomVariation,\n        articleId: articleId,\n      })\n    );\n    return randomVariation;\n  }\n\n  return assignedVariation.variation;\n};\n\n// Track \"Sign up\" button and send the event to the analytics backend.\nconst trackSignUpClick = () => {\n  trackEvent({ event: 'SignUpButtonClick' });\n  // Update CTR\n};\n\n// Function to determine the winning variation by comparing the click-through rates (CTR) of the variations.\nconst determineWinningVariation = (articleId) => {\n  // Retrieve the CTR data for the variations of the article from the dummy data.\n  let article = 'article' + articleId;\n  const ctrData = data[article].ctr;\n\n  // Compare the CTRs and determine the winning variation.\n  let winningVariation = null;\n  let maxCTR = 0;\n\n  for (const variation in ctrData) {\n    const ctr = ctrData[variation];\n\n    if (ctr > maxCTR) {\n      maxCTR = ctr;\n      winningVariation = variation;\n    }\n  }\n\n  return winningVariation;\n};\n\n// Function to render an article with the assigned variation.\nconst renderArticle = (articleId, variation) => {\n  const articleContainer = document.querySelector('.article-container');\n  let article = 'article' + articleId;\n  const articleContent = data[article].content;\n  articleContainer.innerHTML = `\n    <h1>Check out the Blinkist app</h1>\n    <img width=\"300\" src=${articleContent[variation].image} alt=\"Check out the Blinkist app\" />\n    <div>${articleContent[variation].description}</div>\n    <div>Thanks a lot for reading the article! <button id=\"signUpButton\" href=\"/signup\">SIGN UP</button> for Blinkist.</div>\n  `;\n};\n\n// Function to get the current visitor's ID.\n\nconst getCurrentArticleId = () => {\n  const visitor = JSON.parse(localStorage.getItem('visitor'));\n  if (visitor) return visitor.articleId;\n  return Math.floor(Math.random() * (Object.keys(data).length - 1 + 1)) + 1;\n};\n\n// Assuming there is a configuration object for the article variations.\nconst variations = ['control', 'test'];\n\n// Assign a variation to the visitor for the current article.\n\n// If visitor is unique than track the impression\ntrackPageview();\n\nconst articleId = getCurrentArticleId();\nconst assignedVariation = assignVariation(articleId, variations);\n\n// Rendering the article with the assigned variation.\nrenderArticle(articleId, assignedVariation);\n\n// Event listner to track signup events\nconst signUpButton = document.getElementById('signUpButton');\nsignUpButton.addEventListener('click', trackSignUpClick); //Onclick calculate CTR\n\n// Calculating the winning variation\nconst winningVariation = determineWinningVariation(articleId);\n"]}